var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function i(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function r(t){t.parentNode.removeChild(t)}function c(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function u(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function d(){return f(" ")}function g(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function p(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function h(t,e){t.value=null==e?"":e}let m;function v(t){m=t}function w(t){(function(){if(!m)throw new Error("Function called outside component initialization");return m})().$$.on_mount.push(t)}const b=[],$=[],x=[],y=[],_=Promise.resolve();let I=!1;function C(t){x.push(t)}const k=new Set;let S=0;function P(){const t=m;do{for(;S<b.length;){const t=b[S];S++,v(t),E(t.$$)}for(v(null),b.length=0,S=0;$.length;)$.pop()();for(let t=0;t<x.length;t+=1){const e=x[t];k.has(e)||(k.add(e),e())}x.length=0}while(b.length);for(;y.length;)y.pop()();I=!1,k.clear(),v(t)}function E(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(C)}}const A=new Set;function D(t,e){-1===t.$$.dirty[0]&&(b.push(t),I||(I=!0,_.then(P)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function F(l,s,a,c,u,f,d,g=[-1]){const p=m;v(l);const h=l.$$={fragment:null,ctx:null,props:f,update:t,not_equal:u,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(s.context||(p?p.$$.context:[])),callbacks:n(),dirty:g,skip_bound:!1,root:s.target||p.$$.root};d&&d(h.root);let w=!1;if(h.ctx=a?a(l,s.props||{},((t,e,...n)=>{const o=n.length?n[0]:e;return h.ctx&&u(h.ctx[t],h.ctx[t]=o)&&(!h.skip_bound&&h.bound[t]&&h.bound[t](o),w&&D(l,t)),e})):[],h.update(),w=!0,o(h.before_update),h.fragment=!!c&&c(h.ctx),s.target){if(s.hydrate){const t=function(t){return Array.from(t.childNodes)}(s.target);h.fragment&&h.fragment.l(t),t.forEach(r)}else h.fragment&&h.fragment.c();s.intro&&((b=l.$$.fragment)&&b.i&&(A.delete(b),b.i($))),function(t,n,l,s){const{fragment:a,on_mount:r,on_destroy:c,after_update:u}=t.$$;a&&a.m(n,l),s||C((()=>{const n=r.map(e).filter(i);c?c.push(...n):o(n),t.$$.on_mount=[]})),u.forEach(C)}(l,s.target,s.anchor,s.customElement),P()}var b,$;v(p)}function H(t,e,n){const o=t.slice();return o[12]=e[n].wifi,o[13]=e,o[14]=n,o}function M(t,e,n){const o=t.slice();return o[12]=e[n].wifi,o[15]=e,o[14]=n,o}function O(t){let e,n,o,i,l,c,m,v,w=t[14]+1+"";function b(){t[7].call(l,t[14])}return{c(){e=u("label"),n=f("SSID "),o=f(w),i=d(),l=u("input"),p(e,"for","fname"),p(l,"type","text"),p(l,"maxlength","15"),l.disabled=c=0==t[14],p(l,"class","svelte-113t2gh")},m(r,c){a(r,e,c),s(e,n),s(e,o),a(r,i,c),a(r,l,c),h(l,t[0].wifi[t[14]].ssid),m||(v=g(l,"input",b),m=!0)},p(e,n){t=e,1&n&&l.value!==t[0].wifi[t[14]].ssid&&h(l,t[0].wifi[t[14]].ssid)},d(t){t&&r(e),t&&r(i),t&&r(l),m=!1,v()}}}function W(t){let e,n,o,i,l,c,m,v,w=t[14]+1+"";function b(){t[8].call(l,t[14])}return{c(){e=u("label"),n=f("Password "),o=f(w),i=d(),l=u("input"),p(e,"for","lname"),p(l,"type","password"),l.disabled=c=0==t[14],p(l,"class","svelte-113t2gh")},m(r,c){a(r,e,c),s(e,n),s(e,o),a(r,i,c),a(r,l,c),h(l,t[0].wifi[t[14]].pwd),m||(v=g(l,"input",b),m=!0)},p(e,n){t=e,1&n&&l.value!==t[0].wifi[t[14]].pwd&&h(l,t[0].wifi[t[14]].pwd)},d(t){t&&r(e),t&&r(i),t&&r(l),m=!1,v()}}}function j(e){let n,i,l,m,v,w,b,$,x,y,_,I,C,k,S,P,E,A,D,F,j,G,N,L,T,X,Y,q,z,B,J,R,U,K,Q,V,Z,tt,et,nt,ot,it,lt,st,at,rt,ct,ut,ft,dt,gt,pt,ht,mt,vt,wt,bt,$t,xt,yt,_t,It,Ct,kt,St,Pt,Et=e[0].wifi,At=[];for(let t=0;t<Et.length;t+=1)At[t]=O(M(e,Et,t));let Dt=e[0].wifi,Ft=[];for(let t=0;t<Dt.length;t+=1)Ft[t]=W(H(e,Dt,t));return{c(){n=u("div"),i=u("h1"),i.textContent="OPEN COMMUNITY SAFETY",l=d(),m=u("div"),v=u("button"),v.textContent="Get settings",w=d(),b=u("button"),b.textContent="Save settings",$=d(),x=u("h2"),x.textContent="Settings",y=d(),_=u("div"),I=u("label"),I.textContent="Device ID",C=d(),k=u("input"),S=d(),P=u("div"),E=u("label"),E.textContent="Websocket Host",A=d(),D=u("input"),F=d(),j=u("div"),G=u("label"),G.textContent="Physical button label",N=d(),L=u("input"),T=d(),X=u("br"),Y=d(),q=u("div"),z=u("h3"),z.textContent="WIFI",B=d(),J=u("div"),R=u("div");for(let t=0;t<At.length;t+=1)At[t].c();U=d(),K=u("div");for(let t=0;t<Ft.length;t+=1)Ft[t].c();var t,o,s,a;Q=d(),V=u("br"),Z=d(),tt=u("div"),et=u("h3"),et.textContent="Geolocation",nt=d(),ot=u("div"),it=u("div"),lt=u("label"),lt.textContent="Latitude",st=d(),at=u("input"),rt=d(),ct=u("div"),ut=u("label"),ut.textContent="Longitude",ft=d(),dt=u("input"),gt=d(),pt=u("div"),ht=u("button"),ht.textContent="Get Geolocation",mt=d(),vt=u("a"),wt=f("Show map"),$t=d(),xt=u("br"),yt=d(),_t=u("div"),It=u("h3"),It.textContent="SSL Certificate",Ct=d(),kt=u("textarea"),t=i,o="color",null===(s="darkcyan")?t.style.removeProperty(o):t.style.setProperty(o,s,a?"important":""),p(v,"class","button button1 svelte-113t2gh"),p(b,"class","button button1 svelte-113t2gh"),p(m,"class","button_ali svelte-113t2gh"),p(I,"for","fname"),p(k,"type","text"),p(k,"name","deviceId"),p(k,"maxlength","40"),p(k,"class","svelte-113t2gh"),p(E,"for","fname"),p(D,"type","text"),p(D,"name","websockethost"),p(D,"class","svelte-113t2gh"),p(G,"for","fname"),p(L,"type","text"),p(L,"name","pbl"),p(L,"maxlength","50"),p(L,"class","svelte-113t2gh"),p(R,"class","flex-item svelte-113t2gh"),p(K,"class","flex-item svelte-113t2gh"),p(J,"class","flex-container svelte-113t2gh"),p(lt,"for","fname"),p(at,"type","text"),p(at,"name","geox"),p(at,"class","svelte-113t2gh"),p(it,"class","flex-item svelte-113t2gh"),p(ut,"for","lname"),p(dt,"type","text"),p(dt,"name","geoy"),p(dt,"class","svelte-113t2gh"),p(ct,"class","flex-item svelte-113t2gh"),p(ot,"class","flex-container svelte-113t2gh"),p(ht,"class","button button1 svelte-113t2gh"),p(pt,"class","button_ali svelte-113t2gh"),p(vt,"target","_blank"),p(vt,"href",bt=`https://www.openstreetmap.org/?mlat=${e[0].latitude}&mlon=${e[0].longitude}#map=19/${e[0].latitude}/${e[0].longitude}`),p(kt,"class","ca svelte-113t2gh"),p(kt,"rows","25"),p(kt,"cols","50"),p(n,"class","bg")},m(t,o){a(t,n,o),s(n,i),s(n,l),s(n,m),s(m,v),s(m,w),s(m,b),s(n,$),s(n,x),s(n,y),s(n,_),s(_,I),s(_,C),s(_,k),h(k,e[0].deviceId),s(n,S),s(n,P),s(P,E),s(P,A),s(P,D),h(D,e[0].websocketHost),s(n,F),s(n,j),s(j,G),s(j,N),s(j,L),h(L,e[0].input01.name),s(n,T),s(n,X),s(n,Y),s(n,q),s(q,z),s(q,B),s(q,J),s(J,R);for(let t=0;t<At.length;t+=1)At[t].m(R,null);s(J,U),s(J,K);for(let t=0;t<Ft.length;t+=1)Ft[t].m(K,null);s(n,Q),s(n,V),s(n,Z),s(n,tt),s(tt,et),s(tt,nt),s(tt,ot),s(ot,it),s(it,lt),s(it,st),s(it,at),h(at,e[0].latitude),s(ot,rt),s(ot,ct),s(ct,ut),s(ct,ft),s(ct,dt),h(dt,e[0].longitude),s(tt,gt),s(tt,pt),s(pt,ht),s(tt,mt),s(tt,vt),s(vt,wt),s(n,$t),s(n,xt),s(n,yt),s(n,_t),s(_t,It),s(_t,Ct),s(_t,kt),h(kt,e[0].caCert_fingerPrint),St||(Pt=[g(v,"click",e[3]),g(b,"click",e[2]),g(k,"input",e[4]),g(D,"input",e[5]),g(L,"input",e[6]),g(at,"input",e[9]),g(dt,"input",e[10]),g(ht,"click",e[1]),g(kt,"input",e[11])],St=!0)},p(t,[e]){if(1&e&&k.value!==t[0].deviceId&&h(k,t[0].deviceId),1&e&&D.value!==t[0].websocketHost&&h(D,t[0].websocketHost),1&e&&L.value!==t[0].input01.name&&h(L,t[0].input01.name),1&e){let n;for(Et=t[0].wifi,n=0;n<Et.length;n+=1){const o=M(t,Et,n);At[n]?At[n].p(o,e):(At[n]=O(o),At[n].c(),At[n].m(R,null))}for(;n<At.length;n+=1)At[n].d(1);At.length=Et.length}if(1&e){let n;for(Dt=t[0].wifi,n=0;n<Dt.length;n+=1){const o=H(t,Dt,n);Ft[n]?Ft[n].p(o,e):(Ft[n]=W(o),Ft[n].c(),Ft[n].m(K,null))}for(;n<Ft.length;n+=1)Ft[n].d(1);Ft.length=Dt.length}1&e&&at.value!==t[0].latitude&&h(at,t[0].latitude),1&e&&dt.value!==t[0].longitude&&h(dt,t[0].longitude),1&e&&bt!==(bt=`https://www.openstreetmap.org/?mlat=${t[0].latitude}&mlon=${t[0].longitude}#map=19/${t[0].latitude}/${t[0].longitude}`)&&p(vt,"href",bt),1&e&&h(kt,t[0].caCert_fingerPrint)},i:t,o:t,d(t){t&&r(n),c(At,t),c(Ft,t),St=!1,o(Pt)}}}function G(t,e,n){var o={MAX_SSID_WIFI:3,websocketHost:"",caCert_fingerPrint:"",latitude:0,longitude:0,deviceId:"",input01:{name:""},wifi:[{ssid:"",pwd:""},{ssid:"",pwd:""},{ssid:"",pwd:""}]};return w((async()=>{})),[o,function(){navigator.geolocation?navigator.geolocation.getCurrentPosition((t=>{n(0,o={latitude:t.coords.latitude,longitude:t.coords.longitude})})):alert("Geolocation is not supported by this browser.")},async function(){if(confirm("Desea guardar los cambios?"))try{let t=await fetch("/setsettings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}),e=await t.json();console.log(e),e&&alert("Guardado")}catch(t){console.log(t)}},async function(){let t=await fetch("/getsettings"),e=await t.json();if(console.log("Retorna settings",o),e){n(0,o={MAX_SSID_WIFI:e.MAX_SSID_WIFI||3,caCert_fingerPrint:e.caCert_fingerPrint||"",websocketHost:e.websocketHost||"",latitude:e.latitude||0,longitude:e.longitude||0,deviceId:e.deviceId||"",input01:{name:e.input01.name||""}}),n(0,o.wifi=[],o),e.wifi&&Array.isArray(e.wifi)&&e.wifi.forEach((t=>{o.wifi.push({ssid:t.ssid,pwd:t.pwd})}));let t=o.MAX_SSID_WIFI+1;o.wifi&&(t=o.MAX_SSID_WIFI-o.wifi.length),console.log(o,t);let i=0;for(;i<t;)o.wifi.push({ssid:"",pwd:""}),i++;console.log("settings: ",o)}},function(){o.deviceId=this.value,n(0,o)},function(){o.websocketHost=this.value,n(0,o)},function(){o.input01.name=this.value,n(0,o)},function(t){o.wifi[t].ssid=this.value,n(0,o)},function(t){o.wifi[t].pwd=this.value,n(0,o)},function(){o.latitude=this.value,n(0,o)},function(){o.longitude=this.value,n(0,o)},function(){o.caCert_fingerPrint=this.value,n(0,o)}]}return new class extends class{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),F(this,t,G,j,l,{})}}({target:document.body,props:{name:"Edwin"}})}();
//# sourceMappingURL=bundle.js.map
